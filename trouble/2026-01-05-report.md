# 2026-01-05 障害レポート

## 検出された不具合一覧

| 通番 | 検出時刻 | 不具合の概要                                           | 原因の推定                                                       | 影響                               | 修正案                                                                          | ステータス |
| :--- | :------- | :----------------------------------------------------- | :--------------------------------------------------------------- | :--------------------------------- | :------------------------------------------------------------------------------ | :--------- |
| No.1 | 15:52    | `TestAIAgent` のプロンプト生成失敗                     | `AIAgent` が `config/ai_prompts.yaml` を見つけられていない可能性 | AI分析機能のテスト不可             | `ConfigLoader` 同様、`AIAgent` 内のパス解決にサブモジュールディレクトリを含める | ✅ 解決済   |
| No.2 | 15:52    | `TestExtractCommand` の実行失敗                        | データの抽出条件またはファイルパスの不整合                       | 抽出機能のリグレッション懸念       | `BaseCommand` 内のインスタンスを適切にパッチするように修正                      | ✅ 解決済   |
| No.3 | 15:52    | `TestAnalyzeCommand` のモック呼び出し失敗              | `asyncio.to_thread` の非同期モック化不足                         | 分析プロセスのスキップまたはエラー | `async def` モックの導入と `BaseCommand` へのパッチ適用                         | ✅ 解決済   |
| No.4 | 15:52    | `TestSentinelOrchestratorIntegration` のレポート未生成 | テスト用 config の DB パス未設定およびインポートミス             | 統合動作の不安定化                 | DB パス設定の修正、`timedelta` インポート追加、`ResultWriter` 修正              | ✅ 解決済   |

## 詳細コンテキスト
- **実行環境**: `/home/irom/project-stock2` (親リポジトリルート)
- **コマンド**: `pytest --cov=stock-analyzer4/src tests/test_*.py`
- **結果**: 206 Passed, 5 Failed
- **カバレッジ**: 全体 80%
